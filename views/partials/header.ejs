<!DOCTYPE html>
<html lang="id" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
    <meta name="description" content="Sistem billing Mikrotik untuk manajemen voucher hotspot dan user PPPoE">
    <meta name="author" content="<%= settings?.company_name || 'Mikrotik Billing System' %>">
    <meta name="robots" content="noindex, nofollow">
    <title><%= title ? title + ' - ' : '' %><%= settings?.company_name || 'Mikrotik Billing System' %></title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/public/images/icons/icon-192x192.png">
    <link rel="icon" type="image/png" href="/public/images/icons/icon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/public/images/icons/icon-16x16.png" sizes="16x16">
    <link rel="mask-icon" href="/public/images/icons/safari-pinned-tab.svg" color="#3b82f6">
    <meta name="msapplication-TileColor" content="#0f172a">
    <meta name="msapplication-config" content="/browserconfig.xml">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Toast Helper - Global untuk semua halaman -->
    <script src="/public/js/toast-helper.js"></script>

    <!-- Critical CSS (inline for performance) -->
    <style>
        /* Critical above-the-fold styles */
        *,::after,::before{box-sizing:border-box}html{-webkit-text-size-adjust:100%;scroll-behavior:smooth}body{margin:0;font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-size:16px;line-height:1.5;color:#f8fafc;background-color:#0f172a;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.main-layout{min-height:100vh;display:flex;flex-direction:column}.header{position:sticky;top:0;z-index:50;background:rgba(15,23,42,.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(71,85,105,.3)}.header-container{max-width:1280px;margin:0 auto;padding:0 1rem;display:flex;align-items:center;justify-content:space-between;height:4rem}.header-logo{display:flex;align-items:center;font-size:1.25rem;font-weight:700;color:#f8fafc;text-decoration:none}.mobile-menu-button{display:flex;align-items:center;justify-content:center;width:2.5rem;height:2.5rem;border:none;border-radius:.5rem;background-color:rgba(71,85,105,.2);color:#cbd5e1;cursor:pointer;transition:all .2s ease}@media (min-width:768px){.mobile-menu-button{display:none}}.mobile-menu-button:hover{background-color:rgba(71,85,105,.3);color:#f8fafc}.main-content{flex:1;display:flex;max-width:1280px;margin:0 auto;width:100%;padding:0 1rem}.content{flex:1;padding:1.5rem;min-width:0}@media (max-width:1023px){.content{padding:1rem}}.loading-spinner{width:1.5rem;height:1.5rem;border:2px solid rgba(71,85,105,.3);border-top:2px solid #3b82f6;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}*{focus{outline:2px solid #3b82f6;outline-offset:2px}}@media (prefers-reduced-motion:reduce){*,::after,::before{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}
    </style>

    <!-- Non-critical CSS (loaded asynchronously) -->
    <link rel="preload" href="/public/css/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/public/css/main.css"></noscript>
    <link rel="preload" href="/public/css/skeleton.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/public/css/skeleton.css"></noscript>
    <link rel="preload" href="/public/css/animations.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/public/css/animations.css"></noscript>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/public/images/favicon.ico">

    <!-- CSRF Token -->
    <meta name="csrf-token" content="<%= csrfToken %>">
</head>
<body class="dark bg-dark-900 text-dark-50 mobile-safe-area" role="document">
    <!-- Skip to main content link for screen readers -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-md z-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
        Skip to main content
    </a>

    <!-- Main Container -->
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-dark-900 border-b border-dark-700 sticky top-0 z-50" role="banner">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16" role="navigation" aria-label="Main navigation">
                    <!-- Logo and Brand -->
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <a href="/" class="flex items-center space-x-2 text-blue-400 hover:text-blue-300 transition-colors" aria-label="Homepage - <%= settings?.company_name || 'Mikrotik Billing' %>">
                                <i class="fas fa-wifi text-xl" aria-hidden="true"></i>
                                <span class="font-bold text-lg"><%= settings?.company_name || 'Mikrotik Billing' %></span>
                            </a>
                        </div>
                    </div>

                    <!-- Desktop Navigation -->
                    <nav class="hidden md:flex items-center space-x-1" aria-label="Primary navigation">
                        <a href="/" class="<%= currentUrl === '/' || currentUrl === '/dashboard' ? 'bg-dark-800 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-800 hover:text-white border-l-2 border-transparent' %> px-4 py-2 rounded-r-md text-sm font-medium transition-all duration-200 flex items-center space-x-2 group" aria-current="<%= currentUrl === '/' || currentUrl === '/dashboard' ? 'page' : 'false' %>">
                            <i class="fas fa-tachometer-alt group-hover:scale-110 transition-transform" aria-hidden="true"></i>
                            <span>Dashboard</span>
                        </a>

                        <!-- Pelanggan Dropdown -->
                        <div class="relative group">
                            <button class="<%= currentUrl && currentUrl.startsWith('/customers') ? 'bg-dark-800 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-800 hover:text-white border-l-2 border-transparent' %> px-4 py-2 rounded-r-md text-sm font-medium transition-all duration-200 flex items-center space-x-2" aria-expanded="false" aria-haspopup="true" id="customers-dropdown">
                                <i class="fas fa-users group-hover:scale-110 transition-transform" aria-hidden="true"></i>
                                <span>Pelanggan</span>
                                <i class="fas fa-chevron-down text-xs ml-1 group-hover:rotate-180 transition-transform duration-200" aria-hidden="true"></i>
                            </button>
                            <div class="absolute left-0 mt-2 w-56 bg-dark-800 border border-dark-700 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2" role="menu" aria-labelledby="customers-dropdown">
                                <div class="p-2" role="none">
                                    <a href="/customers" class="<%= currentUrl === '/customers' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors" role="menuitem" tabindex="-1">
                                        <i class="fas fa-list mr-3 w-4" aria-hidden="true"></i>
                                        <div>
                                            <div class="font-medium">Daftar Pelanggan</div>
                                            <div class="text-xs text-dark-500">Kelola data pelanggan</div>
                                        </div>
                                    </a>
                                    <a href="/customers/create" class="<%= currentUrl === '/customers/create' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-plus mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Tambah Pelanggan</div>
                                            <div class="text-xs text-dark-500">Registrasi pelanggan baru</div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Voucher Dropdown -->
                        <div class="relative group">
                            <button class="<%= currentUrl && currentUrl.startsWith('/vouchers') ? 'bg-dark-800 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-800 hover:text-white border-l-2 border-transparent' %> px-4 py-2 rounded-r-md text-sm font-medium transition-all duration-200 flex items-center space-x-2">
                                <i class="fas fa-ticket group-hover:scale-110 transition-transform"></i>
                                <span>Voucher</span>
                                <i class="fas fa-chevron-down text-xs ml-1 group-hover:rotate-180 transition-transform duration-200"></i>
                            </button>
                            <div class="absolute left-0 mt-2 w-56 bg-dark-800 border border-dark-700 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2">
                                <div class="p-2">
                                    <a href="/vouchers" class="<%= currentUrl === '/vouchers' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-list mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Daftar Voucher</div>
                                            <div class="text-xs text-dark-500">Kelola voucher hotspot</div>
                                        </div>
                                    </a>
                                    <a href="/vouchers/create" class="<%= currentUrl === '/vouchers/create' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-plus mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Buat Voucher</div>
                                            <div class="text-xs text-dark-500">Generate voucher baru</div>
                                        </div>
                                    </a>
                                    <hr class="border-dark-700 my-2">
                                    <a href="/templates" class="<%= currentUrl === '/templates' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-print mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Template</div>
                                            <div class="text-xs text-dark-500">Pengaturan template print</div>
                                        </div>
                                    </a>
                                    <a href="/vendors" class="text-dark-300 hover:bg-dark-700 hover:text-white flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-store mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Manajemen Vendor</div>
                                            <div class="text-xs text-dark-500">Konfigurasi vendor</div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- PPPoE Dropdown -->
                        <div class="relative group">
                            <button class="<%= currentUrl && currentUrl.startsWith('/pppoe') ? 'bg-dark-800 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-800 hover:text-white border-l-2 border-transparent' %> px-4 py-2 rounded-r-md text-sm font-medium transition-all duration-200 flex items-center space-x-2">
                                <i class="fas fa-network-wired group-hover:scale-110 transition-transform"></i>
                                <span>PPPoE</span>
                                <i class="fas fa-chevron-down text-xs ml-1 group-hover:rotate-180 transition-transform duration-200"></i>
                            </button>
                            <div class="absolute left-0 mt-2 w-56 bg-dark-800 border border-dark-700 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2">
                                <div class="p-2">
                                    <a href="/pppoe" class="<%= currentUrl === '/pppoe' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-list mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Daftar PPPoE</div>
                                            <div class="text-xs text-dark-500">Kelola user PPPoE</div>
                                        </div>
                                    </a>
                                    <a href="/pppoe/create" class="<%= currentUrl === '/pppoe/create' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-plus mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Buat PPPoE</div>
                                            <div class="text-xs text-dark-500">Tambah user PPPoE</div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Monitoring -->
                        <a href="/monitor" class="<%= currentUrl && currentUrl.startsWith('/monitor') ? 'bg-dark-800 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-800 hover:text-white border-l-2 border-transparent' %> px-4 py-2 rounded-r-md text-sm font-medium transition-all duration-200 flex items-center space-x-2 group">
                            <i class="fas fa-chart-line group-hover:scale-110 transition-transform"></i>
                            <span>Monitor</span>
                        </a>

                        <!-- Settings Dropdown -->
                        <div class="relative group">
                            <button class="<%= currentUrl && (currentUrl.startsWith('/profiles') || currentUrl.startsWith('/whatsapp') || currentUrl.startsWith('/settings') || currentUrl.startsWith('/plugins')) ? 'bg-dark-800 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-800 hover:text-white border-l-2 border-transparent' %> px-4 py-2 rounded-r-md text-sm font-medium transition-all duration-200 flex items-center space-x-2">
                                <i class="fas fa-cog group-hover:scale-110 transition-transform"></i>
                                <span>Pengaturan</span>
                                <i class="fas fa-chevron-down text-xs ml-1 group-hover:rotate-180 transition-transform duration-200"></i>
                            </button>
                            <div class="absolute left-0 mt-2 w-56 bg-dark-800 border border-dark-700 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2">
                                <div class="p-2">
                                    <a href="/plugins" class="<%= currentUrl && currentUrl.startsWith('/plugins') ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-plug mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Plugin Manager</div>
                                            <div class="text-xs text-dark-500">Kelola plugin sistem</div>
                                        </div>
                                    </a>
                                    <a href="/profiles" class="<%= currentUrl === '/profiles' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-user-cog mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Profil</div>
                                            <div class="text-xs text-dark-500">Pengaturan profil admin</div>
                                        </div>
                                    </a>
                                    <a href="/whatsapp/management" class="<%= currentUrl && currentUrl.startsWith('/whatsapp') ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fab fa-whatsapp mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">WhatsApp</div>
                                            <div class="text-xs text-dark-500">Konfigurasi WhatsApp</div>
                                        </div>
                                    </a>
                                    <a href="/monitor" class="text-dark-300 hover:bg-dark-700 hover:text-white flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-chart-bar mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Monitoring</div>
                                            <div class="text-xs text-dark-500">Analitik & laporan</div>
                                        </div>
                                    </a>
                                    <a href="/settings" class="<%= currentUrl === '/settings' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-3 py-2 text-sm rounded-md transition-colors">
                                        <i class="fas fa-sliders-h mr-3 w-4"></i>
                                        <div>
                                            <div class="font-medium">Sistem</div>
                                            <div class="text-xs text-dark-500">Pengaturan sistem</div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </nav>

                    <!-- User Menu -->
                    <div class="flex items-center space-x-4">
                        <div class="relative group">
                            <button class="flex items-center space-x-2 text-dark-300 hover:text-white transition-colors">
                                <i class="fas fa-user-circle text-lg"></i>
                                <span class="hidden md:block text-sm font-medium"><%= admin?.username %></span>
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <div class="absolute right-0 mt-2 w-48 bg-dark-800 border border-dark-700 rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                                <a href="/profile" class="block px-4 py-2 text-sm text-dark-300 hover:bg-dark-700 hover:text-white transition-colors">
                                    <i class="fas fa-user mr-2"></i>Profil
                                </a>
                                <a href="/logs" class="block px-4 py-2 text-sm text-dark-300 hover:bg-dark-700 hover:text-white transition-colors">
                                    <i class="fas fa-history mr-2"></i>Log Aktivitas
                                </a>
                                <hr class="border-dark-700 my-1">
                                <a href="/logout" class="block px-4 py-2 text-sm text-red-400 hover:bg-dark-700 hover:text-red-300 transition-colors">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </a>
                            </div>
                        </div>

                        <!-- Mobile menu button -->
                        <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-dark-300 hover:bg-dark-800 hover:text-white transition-colors btn-touch touch-feedback" aria-label="Toggle mobile menu" aria-expanded="false" aria-controls="mobile-menu">
                            <i class="fas fa-bars text-lg" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="hidden md:hidden bg-dark-800 border-t border-dark-700 max-h-96 overflow-y-auto" role="navigation" aria-label="Mobile navigation">
                <div class="px-2 pt-2 pb-3 space-y-2">
                    <!-- Dashboard -->
                    <a href="/" class="<%= currentUrl === '/' || currentUrl === '/dashboard' ? 'bg-dark-700 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white border-l-2 border-transparent' %> flex items-center px-3 py-3 rounded-r-md text-base font-medium transition-all duration-200" aria-current="<%= currentUrl === '/' || currentUrl === '/dashboard' ? 'page' : 'false' %>">
                        <i class="fas fa-tachometer-alt mr-3 w-5" aria-hidden="true"></i>
                        <div>
                            <div class="font-medium">Dashboard</div>
                            <div class="text-xs text-dark-500">Ringkasan sistem</div>
                        </div>
                    </a>

                    <!-- Pelanggan Section -->
                    <div class="space-y-1">
                        <div class="text-dark-400 px-3 py-2 text-xs font-semibold uppercase tracking-wider">Pelanggan</div>
                        <a href="/customers" class="<%= currentUrl === '/customers' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-list mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Daftar Pelanggan</div>
                                <div class="text-xs text-dark-500">Kelola data pelanggan</div>
                            </div>
                        </a>
                        <a href="/customers/create" class="<%= currentUrl === '/customers/create' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-plus mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Tambah Pelanggan</div>
                                <div class="text-xs text-dark-500">Registrasi pelanggan baru</div>
                            </div>
                        </a>
                    </div>

                    <!-- Voucher Section -->
                    <div class="space-y-1">
                        <div class="text-dark-400 px-3 py-2 text-xs font-semibold uppercase tracking-wider">Voucher</div>
                        <a href="/vouchers" class="<%= currentUrl === '/vouchers' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-list mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Daftar Voucher</div>
                                <div class="text-xs text-dark-500">Kelola voucher hotspot</div>
                            </div>
                        </a>
                        <a href="/vouchers/create" class="<%= currentUrl === '/vouchers/create' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-plus mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Buat Voucher</div>
                                <div class="text-xs text-dark-500">Generate voucher baru</div>
                            </div>
                        </a>
                        <a href="/templates" class="<%= currentUrl === '/templates' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-print mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Template</div>
                                <div class="text-xs text-dark-500">Pengaturan template print</div>
                            </div>
                        </a>
                        <a href="/vendors" class="text-dark-300 hover:bg-dark-700 hover:text-white flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-store mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Manajemen Vendor</div>
                                <div class="text-xs text-dark-500">Konfigurasi vendor</div>
                            </div>
                        </a>
                    </div>

                    <!-- PPPoE Section -->
                    <div class="space-y-1">
                        <div class="text-dark-400 px-3 py-2 text-xs font-semibold uppercase tracking-wider">PPPoE</div>
                        <a href="/pppoe" class="<%= currentUrl === '/pppoe' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-list mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Daftar PPPoE</div>
                                <div class="text-xs text-dark-500">Kelola user PPPoE</div>
                            </div>
                        </a>
                        <a href="/pppoe/create" class="<%= currentUrl === '/pppoe/create' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-plus mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Buat PPPoE</div>
                                <div class="text-xs text-dark-500">Tambah user PPPoE</div>
                            </div>
                        </a>
                    </div>

                    <!-- Monitor -->
                    <a href="/monitor" class="<%= currentUrl && currentUrl.startsWith('/monitor') ? 'bg-dark-700 text-blue-400 border-l-2 border-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white border-l-2 border-transparent' %> flex items-center px-3 py-3 rounded-r-md text-base font-medium transition-all duration-200">
                        <i class="fas fa-chart-line mr-3 w-5"></i>
                        <div>
                            <div class="font-medium">Monitor</div>
                            <div class="text-xs text-dark-500">Monitoring sistem</div>
                        </div>
                    </a>

                    <!-- Settings Section -->
                    <div class="space-y-1">
                        <div class="text-dark-400 px-3 py-2 text-xs font-semibold uppercase tracking-wider">Pengaturan</div>
                        <a href="/plugins" class="<%= currentUrl && currentUrl.startsWith('/plugins') ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-plug mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Plugin Manager</div>
                                <div class="text-xs text-dark-500">Kelola plugin sistem</div>
                            </div>
                        </a>
                        <a href="/profiles" class="<%= currentUrl === '/profiles' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-user-cog mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Profil</div>
                                <div class="text-xs text-dark-500">Pengaturan profil admin</div>
                            </div>
                        </a>
                        <a href="/whatsapp/management" class="<%= currentUrl && currentUrl.startsWith('/whatsapp') ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fab fa-whatsapp mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">WhatsApp</div>
                                <div class="text-xs text-dark-500">Konfigurasi WhatsApp</div>
                            </div>
                        </a>
                        <a href="/settings" class="<%= currentUrl === '/settings' ? 'bg-dark-700 text-blue-400' : 'text-dark-300 hover:bg-dark-700 hover:text-white' %> flex items-center px-6 py-3 rounded-md text-base transition-colors">
                            <i class="fas fa-sliders-h mr-3 w-5"></i>
                            <div>
                                <div class="font-medium">Sistem</div>
                                <div class="text-xs text-dark-500">Pengaturan sistem</div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Status Bar -->
        <div class="bg-dark-800 border-b border-dark-700 py-2">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                    <div class="flex items-center text-dark-400 text-sm">
                        <i class="far fa-clock mr-2"></i>
                        <span id="currentTime"><%= new Date().toLocaleString('id-ID') %></span>
                    </div>
                    <div class="flex items-center text-dark-400 text-sm mt-2 sm:mt-0">
                        <div id="connectionStatus" class="flex items-center">
                            <i class="fas fa-wifi mr-2"></i>
                            <span>Mikrotik: <span id="mikrotikStatus" class="text-blue-400">Checking...</span></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

  
        <!-- Toast Container -->
        <div id="toastContainer" class="fixed top-20 right-4 z-50 space-y-2">
            <!-- Toast notifications will be dynamically added here -->
        </div>

        <!-- Mobile Floating Action Button -->
        <div class="md:hidden">
            <button id="mobileFabButton" class="mobile-fab" onclick="openMobileActionMenu()">
                <i class="fas fa-plus text-xl"></i>
            </button>
        </div>

        <!-- Mobile Action Menu -->
        <div id="mobileActionMenu" class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 hidden">
            <div class="absolute bottom-20 left-0 right-0 p-4">
                <div class="bg-slate-800 border border-slate-700 rounded-xl p-4 mobile-modal">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-white">Aksi Cepat</h3>
                        <button onclick="closeMobileActionMenu()" class="text-slate-400 hover:text-white">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <a href="/customers/create" class="mobile-button bg-blue-600 hover:bg-blue-700 text-white rounded-lg p-3 text-center">
                            <i class="fas fa-user-plus block mb-2"></i>
                            <span class="text-xs">Pelanggan</span>
                        </a>
                        <a href="/vouchers/create" class="mobile-button bg-purple-600 hover:bg-purple-700 text-white rounded-lg p-3 text-center">
                            <i class="fas fa-ticket block mb-2"></i>
                            <span class="text-xs">Voucher</span>
                        </a>
                        <a href="/pppoe/create" class="mobile-button bg-green-600 hover:bg-green-700 text-white rounded-lg p-3 text-center">
                            <i class="fas fa-network-wired block mb-2"></i>
                            <span class="text-xs">PPPoE</span>
                        </a>
                        <a href="/payments" class="mobile-button bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg p-3 text-center">
                            <i class="fas fa-credit-card block mb-2"></i>
                            <span class="text-xs">Bayar</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Bottom Navigation -->
        <nav class="md:hidden mobile-bottom-nav mobile-safe-area-bottom">
            <a href="/" class="mobile-bottom-nav-item <%= currentUrl === '/' || currentUrl === '/dashboard' ? 'active' : '' %>">
                <i class="fas fa-home text-lg mb-1"></i>
                <span class="text-xs">Beranda</span>
            </a>
            <a href="/customers" class="mobile-bottom-nav-item <%= currentUrl && currentUrl.startsWith('/customers') ? 'active' : '' %>">
                <i class="fas fa-users text-lg mb-1"></i>
                <span class="text-xs">Pelanggan</span>
            </a>
            <button onclick="openMobileActionMenu()" class="mobile-bottom-nav-item">
                <i class="fas fa-plus-circle text-lg mb-1"></i>
                <span class="text-xs">Buat</span>
            </button>
            <a href="/monitor" class="mobile-bottom-nav-item <%= currentUrl && currentUrl.startsWith('/monitor') ? 'active' : '' %>">
                <i class="fas fa-chart-line text-lg mb-1"></i>
                <span class="text-xs">Monitor</span>
            </a>
            <a href="/settings" class="mobile-bottom-nav-item <%= currentUrl === '/settings' ? 'active' : '' %>">
                <i class="fas fa-cog text-lg mb-1"></i>
                <span class="text-xs">Pengaturan</span>
            </a>
        </nav>

        <!-- Toast Initialization Script -->
        <script>
            // Initialize Toast Helper ketika DOM siap
            document.addEventListener('DOMContentLoaded', function() {
                // Pastikan ToastHelper tersedia
                if (typeof window.ToastHelper !== 'undefined') {
                    console.log('✅ Toast Helper initialized successfully');
                } else {
                    console.warn('⚠️ Toast Helper not loaded');
                }
            });

            // Override console methods untuk debugging (opsional)
            if (typeof window.console !== 'undefined' && window.location.hostname === 'localhost') {
                const originalLog = console.log;
                console.log = function(...args) {
                    originalLog.apply(console, args);
                };
            }
        </script>

        <!-- Main Content -->
        <main id="main-content" class="flex-1 mobile-safe-area-top mobile-safe-area-bottom pb-20 md:pb-6" role="main" aria-label="Main content">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 mobile-p-4">

          